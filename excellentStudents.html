<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>优秀学员</title>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/mescroll.min.css">
    <script src="./js/rem.js"></script>
    <script src="./js/url.js"></script>
</head>
<style>
    /*vue*/
    [v-cloak] {
        display: none;
    }
    #app{width: 100%;min-width: 20rem;}
    #app .nav{width: 100%; padding:0.9375rem 0;}
    #app .nav img{position: absolute;left: 0.9375rem;top:1.25rem;width: 0.5625rem;height: 1rem;}
    #app .nav p{width:4.5rem;font-weight: 700;font-size: 1.125rem;}

    #app .wrap{width: 100%;}
    #app .wrap ul{width: 100%;margin-top:0.625rem;}
    #app .wrap ul li{margin:0.9375rem 0.9375rem;padding:0.625rem 0rem;border:0.0625rem solid #F4F4F4;border-radius:0.3125rem;box-shadow:0rem 0rem 0.3125rem 0.0625rem rgba(0,0,0,0.1);}
    #app .wrap ul li div.headImg{width: 3.625rem;align-items: center;} 
    #app .wrap ul li div.headImg img{margin-left:0.5625rem;width: 3rem;height: 3rem;border-radius:50%;}  
    #app .wrap ul li div.stuInfo{margin-left: 0.625rem;width: 16.25rem;}
    #app .wrap ul li div.stuInfo p{font-size: 0.875rem;font-family: 'Microsoft YaHei', '宋体', Tahoma, Arial, sans-serif;line-height: 1.5rem;}
    #app .wrap ul li div.stuInfo p.jobPostion{font-weight: bold;font-size: 1rem;color: #0c0c0c;}
    #app .wrap ul li div.stuInfo p.company{font-size: 0.875rem;color:#414141;}
    #app .wrap ul li div.stuInfo p.company img{width: 0.5rem;height: 0.9375rem;margin-top: 0.1875rem;}
    
    #app .wrap ul li div.stuInfo p.experience{font-size: 0.875rem;}
    #app .wrap ul li div.stuInfo p.experience span:nth-child(1){color:#3a84e9;}
    #app .wrap ul li div.stuInfo p.experience span:nth-child(2){color:#23b461;padding:0rem 0.5rem;}
    #app .wrap ul li div.stuInfo p.experience span:nth-child(3){color:#f3835f;}
    
</style>
<body>
    <div id="app">
        <div class="nav flex justify-center">
            <img src="./img/back.png" alt="back" @click="back">
            <p>优秀学员</p>
        </div>
        <div class="wrap" id="mescroll" class="mescroll">
            <ul v-cloak>
                <li class="flex"  @click="jump(item.id)" v-for="(item,index) in stuInfo">
                    <!-- 头像 -->
                    <div class="headImg flex">
                        <img :src="item.headImg" alt="">
                    </div>
                    <!-- 学生信息 -->
                    <div class="stuInfo">
                        <p class="jobPosition" v-text="item.duty+'-'+item.name"></p>
                        <p class="company flex justify-between">
                            <span v-text="'入职公司:'+item.company"></span>
                            <img src="./img/more.png" alt="">
                        </p>
                        <p class="experience">
                            <span v-text="'薪资待遇:'+item.salary+'k'"></span>
                            <span v-text="'学历:'+item.education">学历：本科</span>
                            <span v-text="'工作经验:'+item.workExperience"></span>
                        </p>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="./js/mescroll.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="./js/rem.js"></script>
<script>
 var app = new Vue({
     el:'#app',
     data(){
         return{
        stuInfo:[],
        mescroll:null,

    }

     },
     mounted(){
         var that = this;
        // fetch1();
        // function fetch1(){
        //     fetch(url+"/studentApi/selStudent?page=1&limit=10",{method:'post'})
        //     .then(function(res){
        //         return res.json();
        //     })
        //     .then(function(data){
        //         console.log(data.data)
        //         that.stuInfo = data.data;
        //         for(let i =0;i<that.stuInfo.length;i++){
        //             that.stuInfo[i].headImg = url1+that.stuInfo[i].img;
        //             that.stuInfo[i].salary = that.stuInfo[i].salary/1000;
        //         }          
        //     })
        // }

        var self = this;
        self.mescroll = new  MeScroll("mescroll", { //请至少在vue的mounted生命周期初始化mescroll,以确保您配置的id能够被找到
            up: {
                callback: self.upCallback, //上拉回调
                empty: {
						//列表第一页无任何数据时,显示的空提示布局; 需配置warpId才显示
						warpId:	"mescroll", //父布局的id (1.3.5版本支持传入dom元素)
						tip: "暂无相关数据~" //提示
					},
            }
        });
     },
     methods: {
         jump:function(id){
             console.log(id)
           window.location.href="entryDetails.html?id="+id;
         },
         back:function(){
            window.location.href='./index.html';
         },
         //上拉回调 page = {num:1, size:10}; num:当前页 ,默认从1开始; size:每页数据条数,默认10
        upCallback: function(page) {
            //联网加载数据
            var self = this;
            getListDataFromNet(page.num, page.size, function(curPageData) {
                // curPageData=[]; //打开本行注释,可演示列表无任何数据empty的配置
                // console.log(curPageData)
                if(page.num == 1) self.stuInfo = [];
                self.stuInfo = self.stuInfo.concat(curPageData);
                console.log(self.stuInfo)
                // for(let i =0;i<self.stuInfo.length;i++){
                //     self.stuInfo[i].headImg = url1+self.stuInfo[i].img;
                //     self.stuInfo[i].salary = self.stuInfo[i].salary/1000;
                // }  
                console.log("page.num="+page.num+", page.size="+page.size+", curPageData.length="+curPageData.length+", self.stuInfo.length==" + self.stuInfo.length);
                self.mescroll.endSuccess(curPageData.length);
            },function () {
                self.mescroll.endErr();
            });
        },
     },    
 });

 function getListDataFromNet(pageNum,pageSize,successCallback,errorCallback) {
     axios.get(url+"/studentApi/selStudent",{
         params:{
            page:pageNum,
            limit:pageSize
         }
     })
     .then(function(response){
         console.log(response)
          var totalSize = response.data.count;
         console.log(totalSize)
         var data = response.data.data;
         var listData=[];//定义一个空数组
         for (var i = (pageNum-1)*pageSize; i < pageNum*pageSize; i++) {
            if(i==data.length) break;
            listData.push(data[i]);
        }
        
        console.log("listData:")
        console.log(listData)
        for(let i =0;i<listData.length;i++){
            listData[i].headImg = url1+listData[i].img;
            listData[i].salary = listData[i].salary/1000;
        }  
        successCallback&&successCallback(listData);
     })
    //  .catch(function(error) {
    //         errorCallback&&errorCallback()//失败回调
    //     });
 }

</script>
</html>